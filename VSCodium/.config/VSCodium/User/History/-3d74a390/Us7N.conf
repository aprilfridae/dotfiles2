# Import the colors generated by matugen
source = ~/.cache/matugen/colors-hyprland.conf

autogenerated = 0 

################
### MONITORS ###
################

monitor = DP-3, 1920x1080@144, 1920x0, 1
monitor = HDMI-A-2, 1920x1080@60, 0x0, 1, mirror, DP-3
monitor = DP-4, 3840x2160@60, 3840x0, 1.67

###################
### MY PROGRAMS ###
###################

$terminal = kitty
$fileManager = thunar
$menu = walker
$browser = zen-browser

#################
### AUTOSTART ###
#################
# Core Services First
exec-once = hyprpm reload -n
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
exec-once = ironbar
exec-once = hypridle
exec-once = swaync
exec-once = walker --gapplication-service
exec-once = hyprctl setcursor Crelly-Cursor-Pack

# Applications - Monitor 2 (DP-4) uses workspaces 6-10
exec-once = [workspace 6 silent] spotify
exec-once = [workspace 6 silent] kitty --class cava_dash -e cava
exec-once = [workspace 7 silent] vesktop

# Applications - Monitor 1 (DP-3) uses workspaces 1-5
exec-once = [workspace 1 silent] kitty --class btop_dash -e btop
exec-once = [workspace 1 silent] kitty --class ascii_viewer --directory /home/river/.LogoSpin/3d-ascii-viewer -e ./3d-ascii-viewer models/fridae.obj -a 2.5 -ZXY
exec-once = [workspace 2 silent] thunar
exec-once = [workspace 2 silent] kitty
exec-once = [workspace 3 silent] vscodium
exec-once = [workspace 4 silent] zen-browser

#Scratchpad
exec-once = [workspace special:magic silent] kitty --class scratch_btop -e btop
exec-once = [workspace special:magic silent] kitty --class scratch_nvtop -e nvtop

# Background/Misc
exec-once = awww-daemon
exec-once = fish -c ocean
exec-once = elephant

#############################
### ENVIRONMENT VARIABLES ###
#############################

misc {
    vrr = 1
}

cursor {
    no_hardware_cursors = false
}

env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,24
env = PROTON_ENABLE_WAYLAND,1
env = SDL_VIDEODRIVER,wayland
env = __GL_GSYNC_ALLOWED,1
env = __GL_VRR_ALLOWED,1
env = IMV_BACKEND,wayland

#####################
### LOOK AND FEEL ###
#####################
general {
    gaps_in = 5
    gaps_out = 5
    border_size = 2
    col.active_border = $color1 $color2 45deg
    col.inactive_border = $background
    layout = dwindle
    allow_tearing = true
}

decoration {
    active_opacity = 0.9
    inactive_opacity = 0.9
    fullscreen_opacity = 1.0
    rounding = 1
    blur {
        enabled = true
        size = 7
        passes = 2
        new_optimizations = true
    }
}

animations {
    enabled = yes

    # Define the curves
    bezier = fluent_decel, 0.1, 1, 0, 1
    bezier = easeOutQuint, 0.23, 1, 0.32, 1

    # Apply the animations
    animation = global, 1, 10, default
    animation = windows, 1, 4.79, easeOutQuint
    animation = workspaces, 1, 5, fluent_decel, slide
    animation = specialWorkspace, 1, 5, fluent_decel, slidevert
}

dwindle {
    pseudotile = true 
    preserve_split = true 
}

misc {
    force_default_wallpaper = 0
    disable_hyprland_logo = true
}

plugin {
    split-monitor-workspaces {
        count = 5
        keep_focused = 0
        enable_notifications = 0
        enable_persistent_workspaces = 1
    }
}

plugin:dynamic-cursors {

    # enables the plugin
    enabled = true

    # sets the cursor behaviour, supports these values:
    # tilt    - tilt the cursor based on x-velocity
    # rotate  - rotate the cursor based on movement direction
    # stretch - stretch the cursor shape based on direction and velocity
    # none    - do not change the cursors behaviour
    mode = stretch

    # minimum angle difference in degrees after which the shape is changed
    # smaller values are smoother, but more expensive for hw cursors
    threshold = 2

}
 

#############
### INPUT ###
#############

input {
    kb_layout = us
    sensitivity = -0.5
    accel_profile = flat
    force_no_accel = true
    kb_options = altwin:swap_alt_win
    follow_mouse = 1
    touchpad {
        natural_scroll = true
    }
}

gesture = 3, horizontal, workspace


###################
### KEYBINDINGS ###
###################

$mainMod = SUPER 

bind = $mainMod, B, exec, $browser    
bind = SUPER, SPACE, exec, walker
bind = $mainMod, L, exec, hyprlock
bind = $mainMod, D, exec, vesktop
bind = SUPER, N, exec, swaync-client -t -sw
bind = SUPER, W, exec,~/.config/walker/menus/wallpapers.sh

bind = $mainMod, Q, exec, $terminal          
bind = $mainMod, C, killactive,
bind = $mainMod, M, exit,                     
bind = $mainMod, E, exec, $fileManager       
bind = $mainMod, V, togglefloating,                        
bind = $mainMod, P, pseudo,                   
bind = $mainMod, J, togglesplit,              

bind = $mainMod, left, movefocus, l
bind = $mainMod, right, movefocus, r
bind = $mainMod, up, movefocus, u
bind = $mainMod, down, movefocus, d

# Switch to the 'slot' on your current monitor
bind = $mainMod, 1, split-workspace, 1
bind = $mainMod, 2, split-workspace, 2
bind = $mainMod, 3, split-workspace, 3
bind = $mainMod, 4, split-workspace, 4
bind = $mainMod, 5, split-workspace, 5
# Optional: If you want to move the current window to a slot without following it
bind = $mainMod SHIFT, 1, split-movetoworkspace, 1
bind = $mainMod SHIFT, 2, split-movetoworkspace, 2
bind = $mainMod SHIFT, 3, split-movetoworkspace, 3
bind = $mainMod SHIFT, 4, split-movetoworkspace, 4
bind = $mainMod SHIFT, 5, split-movetoworkspace, 5

# Scratchpad Bindings
bind = $mainMod, F, togglespecialworkspace, magic

#Alternatively, if you want to push the window away but stay on your current monitor:
bind = $mainMod SHIFT, right, split-changemonitorsilent, next
bind = $mainMod SHIFT, left, split-changemonitorsilent, prev

bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

##############################
### WINDOWS AND WORKSPACES ###
##############################


# --- LAYER RULES (BLOCK SYNTAX) ---
layerrule {
    name = ironbar_blur
    match:namespace = ^(ironbar)$
    blur = true
    ignore_alpha = 0.1
}

layerrule {
    name = ironbar_popup_blur
    match:namespace = ^(ironbar-popup)$
    blur = true
    ignore_alpha = 0.1
}

layerrule {
    name = walker_effects
    match:namespace = ^(walker)$
    blur = true
    ignore_alpha = 0.5
    xray = 0
}

layerrule {
    name = swaync_control_blur
    match:namespace = ^(swaync-control-center)$
    blur = true
    ignore_alpha = 0.5
    animation = slide right
}

layerrule {
    name = swaync_notif_blur
    match:namespace = ^(swaync-notification-window)$
    blur = true
    ignore_alpha = 0.5
    animation = fade
}


# --- WINDOW RULES ---
# With split-monitor-workspaces and count=5:
# Monitor 1 (DP-3) uses workspace IDs 1-5
# Monitor 2 (DP-4) uses workspace IDs 6-10

windowrule {
    name = spotify
    match:class = ^([Ss]potify)$
    monitor = DP-4
    workspace = 6 silent
    float = on
    size = 1400 800
    move = 450 114
    no_initial_focus = on
}

# Cava (Monitor 2 / DP-4, Workspace 6 = "workspace 1" on DP-4)
windowrule {
    name = cava
    match:class = ^(cava_dash)$
    monitor = DP-4
    workspace = 6 silent
    float = on
    size = 1400 250
    move = 450 929
    no_initial_focus = on
}


# Vesktop/Discord (Monitor 2 / DP-4, Workspace 7 = "workspace 2" on DP-4)
windowrule {
    name = vesktop
    match:class = ^(vesktop)$
    monitor = DP-4
    workspace = 7 silent
    float = on
    size = 1600 1000
    center = on
    no_initial_focus = on
}

# Thunar (Monitor 1 / DP-3, Workspace 2)
windowrule {
    name = thunar
    match:class = ^(thunar)$
    monitor = DP-3
    workspace = 2 silent
    float = on
    size = 910 975
    move = 30 60
    no_initial_focus = on
}

# Kitty (Monitor 1 / DP-3, Workspace 2)
windowrule {
    name = kitty
    match:class = ^(kitty)$
    monitor = DP-3
    workspace = 2 silent
    float = on
    size = 910 975
    move = 980 60
    no_initial_focus = on
}

# VSCodium (Monitor 1 / DP-3, Workspace 3)
windowrule {
    name = vscodium
    match:class = ^(vscodium)$
    monitor = DP-3
    workspace = 3 silent
}

# Zen Browser (Monitor 1 / DP-3, Workspace 4) - Centered
windowrule {
    name = zen
    match:class = ^(zen-alpha|zen)$
    monitor = DP-3
    workspace = 4 silent
    float = on
    size = 1800 975
    move = 60 60
}

windowrule {
    name = btop
    match:class = ^(btop_dash)$
    monitor = DP-3
    workspace = 1 silent
    float = on
    size = 910 960
    move = 30 60
    no_initial_focus = on
}

# 3D ASCII Viewer (Monitor 1 / DP-3, Workspace 1)
windowrule {
    name = ascii-viewer
    match:class = ^(ascii_viewer)$
    monitor = DP-3
    workspace = 1 silent
    float = on
    size = 910 960
    move = 980 60
    no_initial_focus = on
}

# Widgets & Popovers (No Borders)
windowrule {
    name = audio-mixer
    match:class = ^(AudioMixer)$
    float = on
    workspace = unset
    size = 800 500
    move = center
    border_size = 0
}

windowrule {
    name = tray-dash
    match:class = ^(SystemTray)$
    float = on
    workspace = unset
    size = 500 400
    move = center
    border_size = 0
}

windowrule {
    name = hyprshot
    match:title = ^(Hyprshot)$
    float = on
    workspace = unset
    size = 700 500
    move = center
    stay_focused = on
}

windowrule {
    name = file-roller
    match:title = ^(File Roller)$
    float = on
    workspace = unset
    size = 700 500
    move = center
    stay_focused = on
}

windowrule {
    name = polkit-gnome
    match:class = ^(polkit-gnome-authentication-agent-1)$
    float = on
    # In the new syntax, some versions prefer the explicit border_size
    border_size = 0
    move = center
    stay_focused = on
}

# 1. The Global Glassy Effect
windowrule {
    name = scratchpad-glass
    workspace = name:special:magic
    opacity = 0.85 0.85
}

# 1. The Global Glassy Effect
windowrule {
    name = scratchpad-glass
    match:workspace = name:special:magic
    opacity = 0.85 0.85
}

# Btop (Left Side)
windowrule {
    name = scratch-btop
    match:class = ^(scratch_btop)$
    workspace = name:special:magic
    float = on
    size = 910 850
    move = 30 115        # Increased from 50 to 115
    border_size = 0       
    no_initial_focus = on
}

# Nvtop (Right Side)
windowrule {
    name = scratch-nvtop
    match:class = ^(scratch_nvtop)$
    workspace = name:special:magic
    float = on
    size = 910 850
    move = 980 115       # Increased from 50 to 115
    border_size = 0       
    no_initial_focus = on
}